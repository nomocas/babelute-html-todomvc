(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t():typeof define==="function"&&define.amd?define(t):t()})(this,function(){"use strict";var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,n,i){if(n)e(t.prototype,n);if(i)e(t,i);return t}}();function t(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var n={emitDelay:10,strictMode:false};var i=function(){function i(){var e=arguments.length<=0||arguments[0]===undefined?n:arguments[0];t(this,i);var r=void 0,o=void 0;if(e.hasOwnProperty("emitDelay")){r=e.emitDelay}else{r=n.emitDelay}this._emitDelay=r;if(e.hasOwnProperty("strictMode")){o=e.strictMode}else{o=n.strictMode}this._strictMode=o;this._listeners={};this.events=[]}e(i,[{key:"_addListenner",value:function e(t,n,i){if(typeof n!=="function"){throw TypeError("listener must be a function")}if(this.events.indexOf(t)===-1){this._listeners[t]=[{once:i,fn:n}];this.events.push(t)}else{this._listeners[t].push({once:i,fn:n})}}},{key:"on",value:function e(t,n){this._addListenner(t,n,false)}},{key:"once",value:function e(t,n){this._addListenner(t,n,true)}},{key:"off",value:function e(t,n){var i=this;var r=this.events.indexOf(t);var o=t&&r!==-1;if(o){if(!n){delete this._listeners[t];this.events.splice(r,1)}else{(function(){var e=[];var o=i._listeners[t];o.forEach(function(t,i){if(t.fn===n){e.unshift(i)}});e.forEach(function(e){o.splice(e,1)});if(!o.length){i.events.splice(r,1);delete i._listeners[t]}})()}}}},{key:"_applyEvents",value:function e(t,n){var i=this._listeners[t];if(!i||!i.length){if(this._strictMode){throw"No listeners specified for event: "+t}else{return}}var r=[];i.forEach(function(e,t){e.fn.apply(null,n);if(e.once){r.unshift(t)}});r.forEach(function(e){i.splice(e,1)})}},{key:"emit",value:function e(t){var n=this;for(var i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++){r[o-1]=arguments[o]}if(this._emitDelay){setTimeout(function(){n._applyEvents.call(n,t,r)},this._emitDelay)}else{this._applyEvents(t,r)}}},{key:"emitSync",value:function e(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}this._applyEvents(t,i)}},{key:"destroy",value:function e(){this._listeners={};this.events=[]}}]);return i}();var r=i;var o=new r;var s={todos:[],route:"all",ID:0,methods:{append:function e(t){this.todos=this.todos.concat({title:t||"",id:this.ID++,completed:false});this.emit("update",this)},prepend:function e(t){this.todos=[{title:t||"",id:this.ID++,completed:false}].concat(this.todos);this.emit("update",this)},delete:function e(t){this.todos=this.todos.filter(function(e){return e.id!==t});this.emit("update",this)},toggleComplete:function e(t){this.todos=this.todos.map(function(e){if(e.id===t){e=Object.assign({},e);e.completed=!e.completed}return e});this.emit("update",this)},updateTitle:function e(t,n){this.todos=this.todos.map(function(e){if(e.id===t&&e.title!==n){e=Object.assign({},e);e.title=n}return e});this.emit("update",this)},clearCompleted:function e(){this.todos=this.todos.filter(function(e){return!e.completed});this.emit("update",this)},toggleAll:function e(){this.todos=this.todos.map(function(e){e=Object.assign({},e);e.completed=!e.completed;return e});this.emit("update",this)}}};for(var a in s){o[a]=s[a]}for(var l in o.methods){o.methods[l]=o.methods[l].bind(o)}var c=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var u=function e(t,n){if(!(t instanceof n)){throw new TypeError("Cannot call a class as a function")}};var f=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||false;i.configurable=true;if("value"in i)i.writable=true;Object.defineProperty(e,i.key,i)}}return function(t,n,i){if(n)e(t.prototype,n);if(i)e(t,i);return t}}();var d=function e(t,n){if(typeof n!=="function"&&n!==null){throw new TypeError("Super expression must either be null or a function, not "+(typeof n==="undefined"?"undefined":c(n)))}t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}});if(n)Object.setPrototypeOf?Object.setPrototypeOf(t,n):t.__proto__=n};var h=function e(t,n){if(!t){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return n&&((typeof n==="undefined"?"undefined":c(n))==="object"||typeof n==="function")?n:t};var p=function e(t,n,i){u(this,e);this.lexicon=t;this.name=n;this.args=i};var v=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;u(this,e);this._lexems=t||[];this.__babelute__=true}f(e,[{key:"_append",value:function e(t,n,i){this._lexems.push(new p(t,n,i));return this}},{key:"_if",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(t)this._lexems=this._lexems.concat(n._lexems);else if(i)this._lexems=this._lexems.concat(i._lexems);return this}},{key:"_each",value:function e(t,n){var i=this;t.forEach(function(e,t){var r=n(e,t);i._lexems.push.apply(i._lexems,r._lexems)});return this}},{key:"_use",value:function e(t){}},{key:"_lexicon",value:function e(t){}}],[{key:"extends",value:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var i=function e(n){t.call(this,n)};i.prototype=Object.create(t.prototype);i.prototype.constructor=i;for(var r in n){i.prototype[r]=n[r]}return i}}]);return e}();function m(e){return JSON.parse(e,function(e,t){if(t&&t.__babelute__)return new v(t._lexems.map(function(e){return new p(e.lexicon,e.name,e.args)}));return t})}var g=function(e){d(t,e);function t(e){u(this,t);var n=h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.__first_level_babelute__=true;return n}f(t,null,[{key:"getFirstLevelMethod",value:function e(t,n){return function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++){i[r]=arguments[r]}this._lexems.push(new p(t,n,i));return this}}}]);return t}(v);var y=function(){function e(){u(this,e)}f(e,null,[{key:"extends",value:function e(t){var n=function e(){};n.prototype=Object.create(t.prototype);n.prototype.constructor=n;return n}}]);return e}();function _(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var n=e.Initializer=t?y.extends(t):y;e.initializer=new n;e.initializer._empty=function(){return new e};e.initializer.BabeluteClass=e;Object.keys(e).forEach(function(e){b(n,e)});return e.initializer}function b(e,t){e.prototype[t]=function(){return this.BabeluteClass.prototype[t].apply(new this.BabeluteClass,arguments)}}["_use","_each","_if","_append","_lexicon"].forEach(function(e){b(y,e)});var w={};var x=function(){function e(t){var n=this;var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;u(this,e);this.parent=i;i=i||{};this.name=t;this.Atomic=A(i.Atomic||v);this.FirstLevel=A(i.FirstLevel||g);this.SecondLevel=v.extends(i.SecondLevel||v);this.secondLevel=new this.SecondLevel;if(i.Atomic)Object.keys(i.Atomic.initializer).forEach(function(e){b(n.Atomic.Initializer,e);b(n.FirstLevel.Initializer,e)})}f(e,[{key:"addAtoms",value:function e(t){var n=this;t.forEach(function(e){return L(n,e)});return this}},{key:"addCompounds",value:function e(t){var n=this;var i=t(this.Atomic.initializer);for(var r in i){this.Atomic.prototype[r]=i[r]}var o=t(this.FirstLevel.initializer);for(var s in o){this.SecondLevel.prototype[s]=o[s]}Object.keys(i).forEach(function(e){n.FirstLevel.prototype[e]=g.getFirstLevelMethod(n.name,e);b(n.Atomic.Initializer,e);b(n.FirstLevel.Initializer,e)});return this}},{key:"addAliases",value:function e(t){var n=this;Object.keys(t).forEach(function(e){n.Atomic.prototype[e]=n.FirstLevel.prototype[e]=n.SecondLevel.prototype[e]=t[e];b(n.Atomic.Initializer,e);b(n.FirstLevel.Initializer,e)});return this}},{key:"use",value:function e(t,n,i,r){var o=r?this.FirstLevel.instance:this.Atomic.instance;if(!o[n])throw new Error("Babelute ("+this.name+") : method not found : "+n);o[n].apply(t,i)}},{key:"translateToAtomic",value:function e(t,n){return O(t,this.Atomic,n||this.targets)}},{key:"translateToFirstLevel",value:function e(t,n){return O(t,this.FirstLevel,n||this.targets)}},{key:"initializer",value:function e(t){return t?this.FirstLevel.initializer:this.Atomic.initializer}},{key:"createDialect",value:function t(n){return new e(n,this)}}]);return e}();function L(e,t){e.Atomic.prototype[t]=e.FirstLevel.prototype[t]=e.SecondLevel.prototype[t]=g.getFirstLevelMethod(e.name,t);b(e.Atomic.Initializer,t);b(e.FirstLevel.Initializer,t)}function A(e){var t=v.extends(e);_(t,e.Initializer);t.instance=new t;return t}function k(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return new x(e,t)}function C(e){var t=w[e];if(!t)throw new Error("lexicon not found : "+e);return t}function E(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;w[t||e.name]=e}v.prototype._lexicon=function(e){return new(C(e).Atomic)(this._lexems)};g.prototype._lexicon=function(e){return new(C(e).FirstLevel)(this._lexems)};v.prototype._use=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++){n[i-1]=arguments[i]}return e?F(this,e,n,false):this};g.prototype._use=function(e){return e?F(this,e,[].slice.call(arguments,1),true):this};function F(e,t,n,i){if(typeof t==="string"){var r=t.split(":");C(r[0]).use(e,r[1],n,i)}else if(t.__babelute__)e._lexems=e._lexems.concat(t._lexems);return e}function O(e,t,n){var i=new t;e._lexems.forEach(function(e){if(n&&!n[e.lexicon]||this[e.name])this._lexems.push(new p(e.lexicon,e.name,e.args));else this[e.name].apply(this,e.args.map(function(e){if(!e||!e.__babelute__)return e;return O(e,t,n)}))},i);return i}function z(e,t){if(e)return new(C(e)[t?"FirstLevel":"Atomic"]);else if(t)return new g;return new v}function S(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;t=t||C(e.lexicon);return t.secondLevel[e.name].apply(new t.FirstLevel,e.args)}function T(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;t=t||C(e.lexicon);return t.Atomic.prototype[e.name].apply(new t.Atomic,e.args)}function D(e,t){if(!t)return C(e).Atomic.initializer;return C(e).FirstLevel.initializer}var I=function(){function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};u(this,e);this._targets=t;if(n)this.addPragmas(n)}f(e,[{key:"addPragmas",value:function e(t){for(var n in t){this[n]=t[n]}}},{key:"$output",value:function e(){throw new Error("pragmatics.$output should be implemented in subclasses")}}]);return e}();function j(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return new I(e,t)}var P=function(e){d(t,e);function t(e){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;u(this,t);return h(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n))}f(t,[{key:"each",value:function e(t,n,i){var r=n[0],o=n[1];if(r&&r.length)for(var s=0,a=r.length,l,c;s<a;++s){l=r[s];c=o(l,s);if(c)this.$output(t,c,i)}}},{key:"if",value:function e(t,n,i){if(n[0])this.$output(t,n[1],i);else if(n[2])this.$output(t,n[2],i)}},{key:"$output",value:function e(t,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;for(var r=0,o,s=n._lexems.length;r<s;++r){o=n._lexems[r];if(this._targets[o.lexicon]&&this[o.name])this[o.name](t,o.args,i)}return t}}]);return t}(I);function B(e,t){var n=function t(n){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;e.Atomic.call(this);this._subject=n;this._percolator=i};n.prototype=Object.create(e.Atomic.prototype);n.prototype.constructor=n;n.prototype._lexicon=null;n.prototype._append=function(e,n,i){if((!t._targets||t._targets[e])&&t[n])t[n](this._subject,i,this._percolator);return this};return function(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return new n(e,t)}}function M(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;return new P(e,t)}var $={createLexicon:k,createPragmatics:j,createFacadeInitializer:B,createFacadePragmatics:M,init:z,initializer:D,getLexicon:C,registerLexicon:E,developOneLevel:S,developToAtoms:T,fromJSON:m,Babelute:v,Lexem:p,FirstLevel:g,Pragmatics:I,FacadePragmatics:P,Lexicon:x,lexicons:w};function U(e,t){switch(t){case"text":return e.textContent;case"integer":return parseInt(e.textContent,10);case"html":return e.innerHTML;default:throw new Error("content editable casting fail : unrecognised rule : ",t)}}var N=$.createLexicon("html");N.addAtoms(["tag","attr","prop","data","class","classes","id","style","text","onDom","onString","if","each","keyedEach","html","component","ref","container","client","server"]);N.tagsList=["body","div","h1","h2","h3","h4","h5","section","span","button","main","article","hr","header","footer","label","ul","li","p","small","b","strong","i","u","title","meta","table","tr","td","tbody","form","br"];N.eventsList=["click","blur","focus","submit","mouseover","mousedown","mouseup","mouseout","touchstart","touchend","touchcancel","touchleave","touchmove","drop","dragover","dragstart"];N.addAliases({execute:function e(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return this._append("html","execute",[t,i])},switchUse:function e(t){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return this._append("html","switchUse",[t,i])},on:function e(t,n){for(var i=arguments.length,r=Array(i>2?i-2:0),o=2;o<i;o++){r[o-2]=arguments[o]}return this._append("html","on",[t,n,r])}}).addCompounds(function(){var e={};N.tagsList.forEach(function(t){e[t]=function(){return this._append("html","tag",[t,arguments])}});N.eventsList.forEach(function(t){e[t]=function(e){for(var n=arguments.length,i=Array(n>1?n-1:0),r=1;r<n;r++){i[r-1]=arguments[r]}return this._append("html","on",[t,e,i])}});return e}).addCompounds(function(e){return{select:function t(n,i){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:undefined;if(arguments.length===1)return this.tag("select",[n]);return this.tag("select",[e.each(i,function(t){return e.option(t.value,t.label,t.value===n)}),r])},link:function t(n,i,r){return this.tag("link",[e.attr("href",n).attr("rel",i),r])},linkCSS:function t(n){return this.link(n,"stylesheet",e.attr("type","text/css"))},input:function t(n,i,r){return this.tag("input",[e.attr("type",n).prop("value",i),r])},textInput:function e(t,n){return this.input("text",t,n)},passwordInput:function e(t,n){return this.input("password",t,n)},checkbox:function t(n,i){return this.tag("input",[e.attr("type","checkbox").prop("checked",!!n),i])},radio:function t(n,i){return this.tag("input",[e.attr("type","radio").prop("checked",!!n),i])},option:function t(n,i,r){return this.tag("option",[e.attr("value",n).prop("selected",!!r),i])},script:function t(n,i){return this.tag("script",[e.attr("src",n).attr("type","text/javascript"),i])},a:function t(){arguments[0]=e.attr("href",arguments[0]);return this.tag("a",arguments)},img:function t(){arguments[0]=e.attr("src",arguments[0]);return this.tag("img",arguments)},nbsp:function e(){return this.text(" ")},visible:function e(t){return this.style("visibility",t?"visible":"hidden")},display:function e(t){return this.style("display",typeof t==="string"?t:t?"block":"none")},disabled:function e(t){return this.prop("disabled",!!t)},contentEditable:function e(t){var n=t.valueType==="html"?"innerHTML":"textContent";return this.prop("contentEditable",!!t.isEditable).prop(n,t.value||t.placeholder||"").on(t.updateOnEvent||"blur",function(e){var i=U(e.currentTarget,t.valueType||"text");if(i!==t.value)t.updateHandler(i);else if(i==="")e.currentTarget[n]=t.placeholder||""}).click(function(e){if(t.isEditable){if(t.placeholder&&e.currentTarget[n]===t.placeholder)e.currentTarget[n]=""}})}}});var H=$.createLexicon("todomvc",N);H.addCompounds(function(e){return{todomvc:function t(n,i,r){var o=i!=="all"?n.filter(function(e){return i==="completed"?e.completed:!e.completed}):n;return this.div(e.class("todomvc-wrapper").section(e.id("todoapp").class("todoapp").todomvcHeader(r).mainSection(o,n.length,r).statsSection(n,i,r)).todomvcFooter())},mainSection:function t(n,i,r){return this.section(e.id("main").class("main").visible(i).toggleAllButton(r).ul(e.id("todo-list").class("todo-list").each(n,function(t){return e.todoItem(t,r)})))},todomvcHeader:function t(n){return this.header(e.id("header").class("header").h1("Todos").textInput("",e.id("new-todo").class("new-todo").attr("placeholder","What needs to be done?").on("keydown",function(e){if(e.keyCode===13&&e.target.value){n.append(e.target.value);e.target.value=""}})))},toggleAllButton:function t(n){return this.checkbox(false,e.id("toggle-all").class("toggle-all").attr("name","toggle").on("click",n.toggleAll)).label(e.attr("for","toggle-all"),"Mark all as complete")},todoLabel:function t(n,i,r){return this.label(i,e.prop("contentEditable",true).on("keyup",function(e){if(e.keyCode===27)n.updateTitle(r,i);else n.updateTitle(r,e.target.textContent)}))},todoItem:function t(n,i){return this.li(e.class("completed",n.completed).div(e.class("view").checkbox(n.completed,e.class("toggle").click(function(){return i.toggleComplete(n.id)})).todoLabel(i,n.title,n.id).button(e.class("destroy").click(function(){return i.delete(n.id)}))))},todomvcFooter:function t(){return this.footer(e.id("info").class("info").p("Written by ",e.a("https://github.com/nomocas","nomocas")).p("Part of ",e.a("http://todomvc.com","TodoMVC")))},statsSectionNav:function t(n){return this.ul(e.id("filters").class("filters").li(e.a("#/",e.class("selected",n==="all"),"All")).li(e.a("#/active",e.class("selected",n==="active"),"Active")).li(e.a("#/completed",e.class("selected",n==="completed"),"Completed")))},clearCompletedButton:function t(n,i){return this.button(e.id("clear-completed").class("clear-completed").visible(n>0).on("dblclick",i.clearCompleted),"Clear completed ("+n+")")},statsSection:function t(n,i,r){var o=n.filter(function(e){return!e.completed}).length,s=n.length-o;return this.footer(e.id("footer").class("footer").visible(n.length).span(e.id("todo-count").class("todo-count").strong(o),(o===1?" item":" items")+" left").statsSectionNav(i).clearCompletedButton(s,r))}}});var W={html:true};var J={attr:function e(t,n){t.removeAttribute(n.args[0])},class:function e(t,n){if(n.args[0])t.classList.remove(n.args[0])},classes:function e(t,n){var i=n.args[0].split(/\s+/);i.forEach(function(e){if(e)t.classList.remove(e)})},prop:function e(t,n){delete t[n.args[0]]},data:function e(t,n){delete t.dataset[n.args[0]]},style:function e(t,n){delete t.style[n.args[0]]},id:function e(t){delete t.id},on:function e(t,n){t.removeEventListener(n.args[0],n.listener)},onDom:function e(t,n,i){var r=n.args[2];if(r)r(t,n,i)},html:function e(t,n){if(n.html)n.html.forEach(function(e){return t.removeChild(e)})},text:function e(t,n){t.removeChild(n.child)},each:function e(t,n,i){n.children.forEach(function(e){return V(t,e,i)})},tag:function e(t,n){var i=n.args[1],r=i.length;for(var o=0;o<r;++o){Y(i[o])}t.removeChild(n.child)}};function V(e,t,n){for(var i=0,r=t._lexems,o,s=r.length;i<s;++i){o=r[i];if(!W[o.lexicon])continue;if(J[o.name])J[o.name](e,o,n);else if(o.developed)V(e,o.developed,n);if(o.witness)e.removeChild(o.witness)}}function Y(e){var t=void 0;for(var n=0,i=e._lexems,r,o=i.length;n<o;++n){r=i[n];if(W[r.lexicon]){if(r.children)q(r.children);else if(r.name==="tag")q(r.args[1]);else if(r.name==="onDom")J.onDom(r.$tag,r);else if(r.instance){t=r.instance;Y(t.developed);t.componentWillUnmount&&(t.componentWillUnmount(),t.componentDidUnmount())}else if(r.developed)Y(r.developed)}}}function q(e){var t=e.length;for(var n=0;n<t;++n){Y(e[n])}}function R(e,t){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;if(!e)return;var i=document.createElement("div"),r=[];var o=void 0;if(e[0]!=="<"){e="<p>"+e+"</p>";o=true}i.innerHTML=e;var s=o?i.firstChild:i,a=[].slice.call(s.childNodes);var l=void 0;if(n)l=document.createDocumentFragment();for(var c=0,u=a.length,f;c<u;++c){f=a[c];r.push(f);(l||t).appendChild(f)}if(n)t.insertBefore(l,n);return r}var G=function e(t){if(Array.isArray(t)){for(var n=0,i=Array(t.length);n<t.length;n++){i[n]=t[n]}return i}else{return Array.from(t)}};var K={class:function e(t,n){var i=n.args;if(i[0]&&(i.length===1||i[1]))t.classList.add(i[0])},classes:function e(t,n){var i=n.args[0].split(/\s+/);i.forEach(function(e){if(e)t.classList.add(e)})},attr:function e(t,n){var i=n.args;t.setAttribute(i[0],i[1])},prop:function e(t,n){var i=n.args;t[i[0]]=i[1]},data:function e(t,n){var i=n.args;t.dataset[i[0]]=i[1]},style:function e(t,n){var i=n.args;t.style[i[0]]=i[1]},id:function e(t,n){t.id=n.args[0]},on:function e(t,n){var i=n.args,r=n.closure={handler:i[1],args:i[2]};n.listener=function(e){r.handler.apply(r,[e].concat(G(r.args)))};t.addEventListener(i[0],n.listener)},tag:function e(t,n,i,r){n.child=document.createElement(n.args[0]);(r||t).appendChild(n.child);var o=n.args[1];for(var s=0,a=o.length,l;s<a;++s){l=o[s];if(typeof l==="undefined")l="";if(!l||!l.__babelute__)l=o[s]=(new $.Babelute)._append("html","text",[l]);Q(n.child,l,i)}},text:function e(t,n,i,r){n.child=document.createTextNode(n.args[0]);(r||t).appendChild(n.child)},if:function e(t,n,i,r){var o=n.args[0]?n.args[1]:n.args[2]?n.args[2]:null;if(o){n.developed=typeof o==="function"?o(n.args[0]):o;Q(t,n.developed,i,r)}n.witness=document.createComment("if");t.appendChild(n.witness)},each:function e(t,n,i,r){var o=n.args,s=o[0]=o[0]||[],a=o[1];n.children=[];for(var l=0,c=s.length,u;l<c;++l){u=a(s[l],l);n.children.push(u);Q(t,u,i,r)}n.witness=document.createComment("each");t.appendChild(n.witness)},onDom:function e(t,n,i,r){var o=n.args[0];n.$tag=t;if(o)o(t,n,i,r)},html:function e(t,n){n.html=R(n.args[0],t);n.witness=document.createComment("html");t.appendChild(n.witness)},execute:function e(t,n){n.args[0].apply(null,n.args[1])},ref:function e(t,n,i){i&&(i[n.args[0]]=t)},switchUse:function e(t,n,i,r){var o;n.developed=(o=new $.FirstLevel)._use.apply(o,[n.args[0]].concat(G(n.args[1])));Q(t,n.developed,i,r);n.witness=document.createComment("switchUse");t.appendChild(n.witness)}};function Q(e,t,n,i){for(var r=0,o,s=t._lexems,a=s.length;r<a;++r){o=s[r];if(!W[o.lexicon])continue;if(K[o.name])K[o.name](e,o,n,i);else{if(!o.args||!o.args.length)o.developed=$.developToAtoms(o,W[o.lexicon]);else o.developed=$.developOneLevel(o,W[o.lexicon]);o.developed&&Q(e,o.developed,n,i)}}}var X={if:function e(t,n,i,r){n.witness=i.witness;var o=n.args,s=i.args;var a=void 0;if(!o[0]!==!s[0]){if(!o[0]||s[2])V(t,i.developed,r);a=o[0]?o[1]:o[2];if(a){var l=document.createDocumentFragment();n.developed=typeof a==="function"?a():a;Q(t,n.developed,r,l);t.insertBefore(l,n.witness)}}else{a=o[0]?o[1]:o[2];if(a){n.developed=typeof a==="function"?a():a;Z(t,n.developed,i.developed,r)}}},each:function e(t,n,i,r){var o=n.args[0]||[],s=n.args[1],a=i.children,l=o.length,c=a.length,u=n.children=new Array(l);var f=void 0,d=void 0,h=void 0,p=0;n.witness=i.witness;if(l>c)d=document.createDocumentFragment();for(;p<l;++p){h=o[p];f=s(h,p);u[p]=f;if(p<c)Z(t,f,a[p],r);else Q(t,f,r,d)}for(;p<c;++p){V(t,a[p],r)}if(d)t.insertBefore(d,n.witness)},tag:function e(t,n,i,r){n.child=i.child;var o=n.args[1],s=i.args[1];var a=void 0,l=void 0;for(var c=0,u=o.length;c<u;c++){a=o[c];l=s[c];if(a===l)continue;if(typeof a==="undefined")a="";if(!a||!a.__babelute__)a=o[c]=(new $.Babelute)._append("html","text",[a]);Z(n.child,a,l,r)}},text:function e(t,n,i){var r=n.args[0];n.child=i.child;if(r!==i.args[0])n.child.nodeValue=r},class:function e(t,n,i){var r=n.args[0],o=i.args[0],s=n.args[1],a=i.args[1];if(r!==o){if(o)t.classList.remove(o);if(r&&(n.args.length===1||s))t.classList.add(r)}else if(r&&n.args.length>1&&!s!==!a)t.classList.toggle(r)},classes:function e(){},attr:function e(t,n,i){var r=n.args[0],o=n.args[1],s=i.args[0],a=i.args[1];if(r!==s){t.removeAttribute(s);t.setAttribute(r,o)}else if(o!==a)t.setAttribute(r,o)},prop:function e(t,n,i){var r=n.args[0],o=n.args[1],s=i.args[0];if(r!==s){delete t[s];t[r]=o}else if(o!==t[r])t[r]=o},data:function e(t,n,i){var r=n.args[0],o=n.args[1],s=i.args[0],a=i.args[1];if(r!==s){delete t.dataset[s];t.dataset[r]=o}else if(o!==a)t.dataset[r]=o},style:function e(t,n,i){var r=n.args[0],o=n.args[1],s=i.args[0],a=i.args[1];if(r!==s){delete t.style[s];t.style[r]=o}else if(o!==a)t.style[r]=o},id:function e(t,n,i){var e=n.args[0];if(e!==i.args[0])t.id=e},on:function e(t,n,i){var r=n.args[0],o=i.args[0];if(r!==o){t.removeEventListener(o,i.listener);K.on(t,n)}else{var s=n.closure=i.closure;n.listener=i.listener;s.handler=n.args[1];s.args=n.args[2]}},onDom:function e(t,n,i,r){var o=n.args[1];n.$tag=t;if(o)o(t,n,i,r)},html:function e(t,n,i){var r=n.args[0];n.witness=i.witness;if(i.args[0]!==r){i.html&&i.html.forEach(function(e){return t.removeChild(e)});n.html=R(r,t,n.witness)}},execute:function e(t,n,i){if(n.args[0]!==i.args[0]||!ee(n.args[1],i.args[1]))return;n.args[0].apply(null,n.args[1])},component:function e(t,n,i){if(n.args[0]!==i.args[0])throw new Error("You must not change component's class when rerendering");n.instance=i.instance;n.witness=i.witness;n.instance.setProps(n.args[1])},switchUse:function e(t,n,i,r){var o=n.args[0],s=n.args[1];n.witness=i.witness;if(o!==i.args[0]){var a;V(t,i.developed,r);n.developed=(a=new $.FirstLevel)._use.apply(a,[o].concat(G(s)));var l=document.createDocumentFragment();Q(t,n.developed,r,l);t.insertBefore(l,n.witness)}else if(ee(s,i.args[1])){var c;n.developed=(c=new $.FirstLevel)._use.apply(c,[o].concat(G(s)));Z(t,n.developed,i.developed,r)}else n.developed=i.developed}};function Z(e,t,n,i){for(var r,o,s=0,a=t._lexems.length;s<a;++s){r=t._lexems[s];if(!W[r.lexicon])continue;o=n._lexems[s];if(!r.args.length)r.developed=o.developed;else{if(X[r.name])X[r.name](e,r,o,i);else if(ee(r.args,o.args)){r.developed=$.developOneLevel(r,W[r.lexicon]);Z(e,r.developed,o.developed,i)}else r.developed=o.developed}}}function ee(e,t){for(var n=0,i=e.length;n<i;++n){if(e[n]!==t[n])return true}return false}K.component=function(e,t,n,i){var r=t.instance=new t.args[0](t.args[1],n);te(e,r,true,i)};X.component=function(e,t,n){if(t.args[0]!==n.args[0])throw new Error("You must not change component's class when rerendering");t.instance=n.instance;if(t.args[1])t.instance.setProps(t.args[1])};J.component=function(e,t){t.instance.unmount();e.removeChild(t.instance.witness)};function te(e,t,n,i){t._render=function(){var t=this.render(true);if(this.developed)Z(e,t,this.developed,this);else Q(e,t,this);this.developed=t};t._remove=function(){Y(this.developed);V(e,this.developed,t)};t.componentWillMount();t.developed=t.render(true);Q(e,t.developed,t,i);if(n){t.witness=document.createComment("component");e.appendChild(t.witness)}t.componentDidMount()}K.container=function(e,t,n,i){var r=t.instance={};r.unmount=function(){Y(this.developed);V(e,this.developed,n)}.bind(r);r.developed=t.args[0](r);Q(e,r.developed,n,i)};X.container=function(e,t,n,i){var r=t.instance=n.instance,o=t.args[0](r);Z(e,o,r.developed,i);r.developed=o};J.container=function(e,t){t.instance.unmount()};N.addAliases({$render:function e(t){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(n)return Z(t,this,n);return Q(t,this)},$remove:function e(t){return V(t,this)}});var ne=$.createPragmatics(W,{$output:function e(t,n,i){var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:null;i?Z(t,n,i,r):Q(t,n,r);return n},addLexicon:function e(t,n){this._targets[n||t.name]=t;while(t.parent){t=t.parent;this._targets[t.name]=t}},mountComponentInstance:te,render:Q,dif:Z,remove:V,renderActions:K,difActions:X,removeActions:J,seekAndUnmountComponent:Y,seekAndUnmountComponentInArray:q});var ie=H.initializer(true);var re=document.getElementById("todoapp");ne.addLexicon(H);var oe=void 0;var se=void 0;o.on("update",function(e){if(se)cancelAnimationFrame(se);se=requestAnimationFrame(function(){oe=ne.$output(re,ie.todomvc(e.todos,e.route,e.methods),oe)})});function ae(){o.route=window.location.hash.substring(2)||"all";o.emit("update",o)}window.onhashchange=ae;ae()});